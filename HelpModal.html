<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <!-- SVG Icon Definitions -->
  <svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
    <defs>
      <!-- Refresh Icon -->
      <symbol id="icon-refresh" viewBox="0 0 24 24">
        <path fill="currentColor" d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"/>
      </symbol>

      <!-- Search Icon -->
      <symbol id="icon-search" viewBox="0 0 24 24">
        <path fill="currentColor" d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"/>
      </symbol>

      <!-- Package Icon -->
      <symbol id="icon-package" viewBox="0 0 24 24">
        <path fill="currentColor" d="M21,16.5C21,16.88 20.79,17.21 20.47,17.38L12.57,21.82C12.41,21.94 12.21,22 12,22C11.79,22 11.59,21.94 11.43,21.82L3.53,17.38C3.21,17.21 3,16.88 3,16.5V7.5C3,7.12 3.21,6.79 3.53,6.62L11.43,2.18C11.59,2.06 11.79,2 12,2C12.21,2 12.41,2.06 12.57,2.18L20.47,6.62C20.79,6.79 21,7.12 21,7.5V16.5M12,4.15L6.04,7.5L12,10.85L17.96,7.5L12,4.15M5,15.91L11,19.29V12.58L5,9.21V15.91M19,15.91V9.21L13,12.58V19.29L19,15.91Z"/>
      </symbol>

      <!-- Settings Icon -->
      <symbol id="icon-settings" viewBox="0 0 24 24">
        <path fill="currentColor" d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
      </symbol>

      <!-- Help Icon -->
      <symbol id="icon-help" viewBox="0 0 24 24">
        <path fill="currentColor" d="M10,19H13V22H10V19M12,2C17.35,2.22 19.68,7.62 16.5,11.67C15.67,12.67 14.33,13.33 13.67,14.17C13,15 13,16 13,17H10C10,15.33 10,13.92 10.67,12.92C11.33,11.92 12.67,11.33 13.5,10.67C15.92,8.43 15.32,5.26 12,5A3,3 0 0,0 9,8H6A6,6 0 0,1 12,2Z"/>
      </symbol>

      <!-- Close Icon -->
      <symbol id="icon-close" viewBox="0 0 24 24">
        <path fill="currentColor" d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"/>
      </symbol>

      <!-- Check/Success Icon -->
      <symbol id="icon-check" viewBox="0 0 24 24">
        <path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"/>
      </symbol>

      <!-- Warning Icon -->
      <symbol id="icon-warning" viewBox="0 0 24 24">
        <path fill="currentColor" d="M13,14H11V10H13M13,18H11V16H13M1,21H23L12,2L1,21Z"/>
      </symbol>

      <!-- Info Icon -->
      <symbol id="icon-info" viewBox="0 0 24 24">
        <path fill="currentColor" d="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
      </symbol>

      <!-- Document Icon -->
      <symbol id="icon-document" viewBox="0 0 24 24">
        <path fill="currentColor" d="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M9,7H11V9H9V7M15,17H9V15H15V17M17,13H9V11H17V13M17,9H13V7H17V9Z"/>
      </symbol>

      <!-- Tool/Wrench Icon -->
      <symbol id="icon-tool" viewBox="0 0 24 24">
        <path fill="currentColor" d="M22.7,19L13.6,9.9C14.5,7.6 14,4.9 12.1,3C10.1,1 7.1,0.6 4.7,1.7L9,6L6,9L1.6,4.7C0.4,7.1 0.9,10.1 2.9,12.1C4.8,14 7.5,14.5 9.8,13.6L18.9,22.7C19.3,23.1 19.9,23.1 20.3,22.7L22.6,20.4C23.1,20 23.1,19.3 22.7,19Z"/>
      </symbol>

      <!-- Link Icon -->
      <symbol id="icon-link" viewBox="0 0 24 24">
        <path fill="currentColor" d="M3.9,12C3.9,10.29 5.29,8.9 7,8.9H11V7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H11V15.1H7C5.29,15.1 3.9,13.71 3.9,12M8,13H16V11H8V13M17,7H13V8.9H17C18.71,8.9 20.1,10.29 20.1,12C20.1,13.71 18.71,15.1 17,15.1H13V17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7Z"/>
      </symbol>

      <!-- Heart Icon -->
      <symbol id="icon-heart" viewBox="0 0 24 24">
        <path fill="currentColor" d="M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.41 22,8.5C22,12.27 18.6,15.36 13.45,20.03L12,21.35Z"/>
      </symbol>

      <!-- User Icon -->
      <symbol id="icon-user" viewBox="0 0 24 24">
        <path fill="currentColor" d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
      </symbol>

      <!-- Office Building Icon -->
      <symbol id="icon-office" viewBox="0 0 24 24">
        <path fill="currentColor" d="M5,3V21H11V17.5H13V21H19V3H5M7,5H9V7H7V5M11,5H13V7H11V5M15,5H17V7H15V5M7,9H9V11H7V9M11,9H13V11H11V9M15,9H17V11H15V9M7,13H9V15H7V13M11,13H13V15H11V13M15,13H17V15H15V13M7,17H9V19H7V17M15,17H17V19H15V17Z"/>
      </symbol>

      <!-- Book Icon -->
      <symbol id="icon-book" viewBox="0 0 24 24">
        <path fill="currentColor" d="M18,22A2,2 0 0,0 20,20V4C20,2.89 19.1,2 18,2H12V9L9.5,7.5L7,9V2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18Z"/>
      </symbol>

      <!-- Target Icon -->
      <symbol id="icon-target" viewBox="0 0 24 24">
        <path fill="currentColor" d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M12,6A6,6 0 0,0 6,12A6,6 0 0,0 12,18A6,6 0 0,0 18,12A6,6 0 0,0 12,6M12,8A4,4 0 0,1 16,12A4,4 0 0,1 12,16A4,4 0 0,1 8,12A4,4 0 0,1 12,8M12,10A2,2 0 0,0 10,12A2,2 0 0,0 12,14A2,2 0 0,0 14,12A2,2 0 0,0 12,10Z"/>
      </symbol>

      <!-- Rocket Icon -->
      <symbol id="icon-rocket" viewBox="0 0 24 24">
        <path fill="currentColor" d="M13.13,22.19L11.5,18.36C13.07,17.78 14.54,17 15.9,16.09L13.13,22.19M5.64,12.5L1.81,10.87L7.91,8.1C7,9.46 6.22,10.93 5.64,12.5M21.61,2.39C21.61,2.39 16.66,0.269 11,5.93C8.81,8.12 7.5,10.53 6.65,12.64C6.37,13.39 6.56,14.21 7.11,14.77L9.24,16.89C9.79,17.45 10.61,17.63 11.36,17.35C13.5,16.53 15.88,15.19 18.07,13C23.73,7.34 21.61,2.39 21.61,2.39M14.54,9.46C13.76,8.68 13.76,7.41 14.54,6.63C15.32,5.85 16.59,5.85 17.37,6.63C18.14,7.41 18.15,8.68 17.37,9.46C16.59,10.24 15.32,10.24 14.54,9.46M8.88,16.53L7.47,15.12L8.88,16.53M6.24,22L9.88,18.36C9.54,18.27 9.21,18.12 8.91,17.91L4.83,22H6.24M2,22H3.41L8.18,17.24L6.76,15.83L2,20.59V22M2,19.17L6.09,15.09C5.88,14.79 5.73,14.47 5.64,14.12L2,17.76V19.17Z"/>
      </symbol>

      <!-- History/Clock Icon -->
      <symbol id="icon-history" viewBox="0 0 24 24">
        <path fill="currentColor" d="M13.5,8H12V13L16.28,15.54L17,14.33L13.5,12.25V8M13,3A9,9 0 0,0 4,12H1L4.96,16.03L9,12H6A7,7 0 0,1 13,5A7,7 0 0,1 20,12A7,7 0 0,1 13,19C11.07,19 9.32,18.21 8.06,16.94L6.64,18.36C8.27,20 10.5,21 13,21A9,9 0 0,0 22,12A9,9 0 0,0 13,3"/>
      </symbol>
    </defs>
  </svg>
  <style>
    /* SVG Icon Utilities */
    .icon {
      display: inline-block;
      width: 18px;
      height: 18px;
      vertical-align: middle;
      margin-right: 6px;
    }

    .icon-sm {
      width: 14px;
      height: 14px;
    }

    .icon-md {
      width: 18px;
      height: 18px;
    }

    .icon-lg {
      width: 24px;
      height: 24px;
    }

    body {
      font-family: 'Google Sans', Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f8f9fa;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      min-height: 100vh;
    }

    .header {
      background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%);
      color: white;
      padding: 40px 30px;
      text-align: center;
    }

    .header h1 {
      margin: 0;
      font-size: 32px;
      font-weight: 500;
    }

    .header p {
      margin: 12px 0 0 0;
      color: white;
      opacity: 0.95;
      font-size: 16px;
      font-weight: 400;
    }

    .tabs {
      display: flex;
      background: #fff;
      border-bottom: 2px solid #dadce0;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }

    .tab {
      flex: 1;
      padding: 16px 20px;
      text-align: center;
      cursor: pointer;
      border: none;
      background: none;
      font-size: 14px;
      font-weight: 500;
      color: #5f6368;
      transition: all 0.2s ease;
      border-bottom: 3px solid transparent;
    }

    .tab:hover {
      background: #f8f9fa;
      color: #202124;
    }

    .tab.active {
      color: #1a73e8;
      border-bottom-color: #1a73e8;
      background: #e8f0fe;
    }

    .tab-content {
      display: none;
      padding: 40px 30px;
      animation: fadeIn 0.3s ease;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      color: #202124;
      font-size: 28px;
      margin-top: 0;
      margin-bottom: 24px;
      border-bottom: 3px solid #1a73e8;
      padding-bottom: 12px;
      font-weight: 500;
    }

    h3 {
      color: #202124;
      font-size: 20px;
      margin-top: 32px;
      margin-bottom: 16px;
      font-weight: 500;
    }

    p {
      color: #5f6368;
      line-height: 1.7;
      margin-bottom: 16px;
      font-size: 15px;
    }

    .step-box {
      background: #e8f0fe;
      border-left: 4px solid #1a73e8;
      padding: 20px 24px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .step-number {
      display: inline-block;
      background: #1a73e8;
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      text-align: center;
      line-height: 32px;
      font-weight: 500;
      margin-right: 12px;
      font-size: 16px;
    }

    .warning-box {
      background: #fef7e0;
      border-left: 4px solid #f9ab00;
      padding: 20px 24px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .warning-box strong {
      color: #b06000;
    }

    .tip-box {
      background: #e6f4ea;
      border-left: 4px solid #34a853;
      padding: 20px 24px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .tip-box strong {
      color: #137333;
    }

    .info-box {
      background: #e8f0fe;
      border-left: 4px solid #1a73e8;
      padding: 20px 24px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .info-box strong {
      color: #1967d2;
    }

    ul {
      color: #5f6368;
      line-height: 1.8;
      margin-left: 20px;
      font-size: 15px;
    }

    ol {
      color: #5f6368;
      line-height: 1.8;
      margin-left: 20px;
      font-size: 15px;
    }

    code {
      background: #f1f3f4;
      padding: 3px 8px;
      border-radius: 4px;
      font-family: 'Roboto Mono', 'Courier New', monospace;
      color: #d93025;
      font-size: 14px;
    }

    .menu-path {
      background: #e8f0fe;
      padding: 12px 16px;
      border-radius: 4px;
      font-family: 'Roboto Mono', 'Courier New', monospace;
      font-size: 13px;
      color: #1967d2;
      margin: 12px 0;
      border: 1px solid #d2e3fc;
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
      margin: 24px 0;
    }

    .feature-card {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #dadce0;
      transition: all 0.2s;
    }

    .feature-card:hover {
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border-color: #1a73e8;
    }

    .feature-card h4 {
      margin: 0 0 10px 0;
      color: #1a73e8;
      font-size: 17px;
      font-weight: 500;
    }

    .feature-card p {
      margin: 0;
      font-size: 14px;
      color: #5f6368;
    }

    .status-indicator {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      margin: 4px;
    }

    .status-synced {
      background: #e6f4ea;
      color: #137333;
    }

    .status-arena {
      background: #fef7e0;
      color: #b06000;
    }

    .status-local {
      background: #fce8e6;
      color: #c5221f;
    }

    .status-placeholder {
      background: #fce8e6;
      color: #c5221f;
    }

    .status-error {
      background: #fce8e6;
      color: #c5221f;
    }

    /* About / Creator Section */
    .creator-card {
      background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
      border: 2px solid #dadce0;
      border-radius: 12px;
      padding: 40px;
      margin: 40px auto;
      max-width: 600px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .creator-photo {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      margin: 0 auto 24px;
      border: 4px solid #1a73e8;
      box-shadow: 0 4px 12px rgba(26, 115, 232, 0.2);
    }

    .creator-name {
      font-size: 28px;
      font-weight: 500;
      color: #202124;
      margin: 0 0 8px 0;
    }

    .creator-title {
      font-size: 18px;
      color: #5f6368;
      margin: 0 0 24px 0;
    }

    .creator-message {
      font-size: 16px;
      color: #5f6368;
      line-height: 1.7;
      margin: 24px 0;
    }

    .linkedin-button {
      display: inline-block;
      background: #0077b5;
      color: white;
      padding: 14px 32px;
      border-radius: 8px;
      text-decoration: none;
      font-size: 16px;
      font-weight: 500;
      margin-top: 20px;
      transition: all 0.2s;
      box-shadow: 0 2px 8px rgba(0, 119, 181, 0.3);
    }

    .linkedin-button:hover {
      background: #006399;
      box-shadow: 0 4px 12px rgba(0, 119, 181, 0.4);
      transform: translateY(-2px);
    }

    .linkedin-button:before {
      content: "in";
      display: inline-block;
      background: white;
      color: #0077b5;
      width: 24px;
      height: 24px;
      line-height: 24px;
      border-radius: 3px;
      font-weight: bold;
      margin-right: 10px;
      font-size: 18px;
    }

    /* Menu Reference Styles */
    .menu-section {
      margin: 32px 0;
      padding: 24px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #1a73e8;
    }

    .menu-section h3 {
      margin-top: 0;
      color: #1a73e8;
      font-size: 22px;
    }

    .menu-item {
      background: white;
      padding: 16px 20px;
      margin: 12px 0;
      border-radius: 6px;
      border: 1px solid #dadce0;
      transition: all 0.2s;
    }

    .menu-item:hover {
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      border-color: #1a73e8;
    }

    .menu-item-title {
      font-weight: 600;
      color: #202124;
      font-size: 15px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .menu-item-title:before {
      content: "‚ñ∏";
      color: #1a73e8;
      margin-right: 8px;
      font-weight: bold;
    }

    .menu-item-desc {
      color: #5f6368;
      font-size: 14px;
      line-height: 1.6;
      margin: 0;
    }

    .workflow-box {
      background: #e8f0fe;
      border: 2px solid #1a73e8;
      border-radius: 8px;
      padding: 20px;
      margin: 24px 0;
    }

    .workflow-box h4 {
      margin: 0 0 12px 0;
      color: #1a73e8;
      font-size: 18px;
    }

    .workflow-step {
      display: flex;
      align-items: flex-start;
      margin: 12px 0;
    }

    .workflow-step-num {
      background: #1a73e8;
      color: white;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
      flex-shrink: 0;
      margin-right: 12px;
    }

    .workflow-step-text {
      color: #202124;
      font-size: 14px;
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 id="headerTitle">Arena PLM Integration - Help Guide</h1>
      <p id="headerSubtitle">Your complete guide to managing configurations with Arena PLM</p>
    </div>

    <div class="tabs">
      <button class="tab active" onclick="showTab(0)">Getting Started</button>
      <button class="tab" onclick="showTab(1)">Menu Reference</button>
      <button class="tab" onclick="showTab(2)">Configuration</button>
      <button class="tab" onclick="showTab(3)">Creating Content</button>
      <button class="tab" onclick="showTab(4)">Status & History</button>
      <button class="tab" onclick="showTab(5)">Publishing</button>
      <button class="tab" onclick="showTab(6)">About</button>
    </div>

    <!-- Tab 1: Getting Started -->
    <div class="tab-content active">
      <h2>Welcome! Let's Get You Started</h2>

      <p>Welcome! This tool helps you design layouts, manage configurations, and sync everything with Arena PLM. Let's get you up and running!</p>

      <h3>Step 1: Connect to Arena</h3>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Open the configuration menu</strong>
        <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Configure Arena Connection</div>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Enter your Arena credentials</strong>
        <ul>
          <li><strong>Arena URL:</strong> Your Arena workspace URL (e.g., https://yourcompany.arenasolutions.com)</li>
          <li><strong>Email:</strong> Your Arena login email</li>
          <li><strong>Password:</strong> Your Arena password</li>
          <li><strong>Workspace ID:</strong> Your Arena workspace ID (found in Arena settings)</li>
        </ul>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Test the connection</strong>
        <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Test Connection</div>
        <p>Verify everything is working correctly before proceeding.</p>
      </div>

      <div class="tip-box">
        <strong>Pro Tip:</strong> Your credentials are stored securely in Google's property service and are only accessible by this spreadsheet.
      </div>

      <h3>What This Tool Does</h3>
      <div class="feature-grid">
        <div class="feature-card">
          <h4>Configuration Management</h4>
          <p>Create and configure item BOMs with components from Arena</p>
        </div>
        <div class="feature-card">
          <h4>Layout Design</h4>
          <p>Design layouts with visual item placement in grid positions</p>
        </div>
        <div class="feature-card">
          <h4>BOM Automation</h4>
          <p>Automatically generate consolidated BOMs from your layouts</p>
        </div>
        <div class="feature-card">
          <h4>Arena Sync</h4>
          <p>Push hierarchical structures directly to Arena PLM</p>
        </div>
        <div class="feature-card">
          <h4>Status Tracking</h4>
          <p>Visual indicators show sync status for all configurations</p>
        </div>
        <div class="feature-card">
          <h4>History Logging</h4>
          <p>Complete audit trail of all changes and events</p>
        </div>
      </div>
    </div>

    <!-- Tab 2: Menu Reference -->
    <div class="tab-content">
      <h2>Complete Menu Reference</h2>

      <p>This guide explains every menu item in the Arena menu and how they work together in your workflow.</p>

      <div class="workflow-box">
        <h4><svg class="icon icon-md"><use href="#icon-refresh"></use></svg>Typical Workflow</h4>
        <div class="workflow-step">
          <div class="workflow-step-num">1</div>
          <div class="workflow-step-text"><strong>Setup:</strong> Configure Arena Connection ‚Üí Configure Type System ‚Üí Set up columns and colors</div>
        </div>
        <div class="workflow-step">
          <div class="workflow-step-num">2</div>
          <div class="workflow-step-text"><strong>Design:</strong> Create Overview Layout ‚Üí Create configurations using Item Picker ‚Üí Build BOMs</div>
        </div>
        <div class="workflow-step">
          <div class="workflow-step-num">3</div>
          <div class="workflow-step-text"><strong>Review:</strong> Check Status ‚Üí View History ‚Üí Create Consolidated BOM</div>
        </div>
        <div class="workflow-step">
          <div class="workflow-step-num">4</div>
          <div class="workflow-step-text"><strong>Publish:</strong> Push Structure to Arena ‚Üí Verify in Arena PLM</div>
        </div>
      </div>

      <!-- Create Layout Section -->
      <div class="menu-section">
        <h3>üìê Create Layout</h3>

        <div class="menu-item">
          <div class="menu-item-title">New Configuration</div>
          <p class="menu-item-desc">Creates a new configuration sheet for designing your product structure. Each configuration represents a unique assembly with its own bill of materials (BOM). You can build multiple configurations and then place them in overview layouts.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">New Overview Layout</div>
          <p class="menu-item-desc">Creates a visual grid layout where you can arrange multiple configurations. Think of this as your master layout plan - it shows how all your configurations are organized spatially. Perfect for data center floor plans, production line layouts, or warehouse shelving arrangements.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Clone Existing Rack ‚ßâ</div>
          <p class="menu-item-desc"><strong>NEW!</strong> Duplicate an existing rack configuration to create variants. Opens Rack Picker in clone mode where you can search for a rack to copy. Perfect for creating "Type A" ‚Üí "Type B" variants without rebuilding from scratch. All BOM data and formatting are preserved. Creates a PLACEHOLDER rack ready for customization.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Load Arena Item as Template üåê</div>
          <p class="menu-item-desc"><strong>NEW!</strong> Load a comprehensive Arena BOM as a template for customization (the "150% configuration" approach). Opens Rack Picker in template mode where you can browse Arena items, preview their BOMs, and load all components. Ideal when Arena has an item with 50 options and you want to trim down to 15 needed components. Creates a PLACEHOLDER rack with an instruction row reminding you to trim before pushing.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Clone This Rack ‚ßâ</div>
          <p class="menu-item-desc"><strong>NEW!</strong> Quick clone shortcut! This context-sensitive menu item appears ONLY when viewing a rack configuration sheet. Prompts for new item number and name, then instantly creates a clone of the current rack. Fastest way to duplicate the rack you're currently viewing.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Autolink to Overview</div>
          <p class="menu-item-desc">Automatically links existing configurations to cells in your overview layout. Scans your overview sheet and matches item numbers to configuration sheets, creating clickable links. Saves time when you have many configurations to connect.</p>
        </div>
      </div>

      <!-- Item Pickers Section -->
      <div class="menu-section">
        <h3><svg class="icon icon-md"><use href="#icon-search"></use></svg>Item Pickers</h3>

        <div class="menu-item">
          <div class="menu-item-title">Show Item Picker</div>
          <p class="menu-item-desc">Opens a searchable dialog to browse ALL items from Arena PLM. Search by item number, name, or description. Use this to find components to add to BOMs. Features infinite scroll, 6-hour caching for performance, and shows item details including category and lifecycle.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Show Configuration Picker</div>
          <p class="menu-item-desc">Opens a specialized picker showing ONLY your top-level configuration items (filtered by type classification). Perfect for placing configurations in overview layouts or creating hierarchies. Shows item details with color-coded types for easy identification. <strong>TIP:</strong> The <strong>Templates tab</strong> in Rack Picker lets you clone existing racks or load Arena items as templates - look for the clone icon ‚ßâ next to each rack!</p>
        </div>
      </div>

      <!-- BOM Operations Section -->
      <div class="menu-section">
        <h3><svg class="icon icon-md"><use href="#icon-package"></use></svg>BOM Operations</h3>

        <div class="menu-item">
          <div class="menu-item-title">Create Consolidated BOM</div>
          <p class="menu-item-desc">Generates a comprehensive bill of materials by combining all configurations in your overview layout. Automatically calculates total quantities across all positions, groups by component, and creates a master parts list. Essential for procurement and costing.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Push Structure to Arena</div>
          <p class="menu-item-desc">THE BIG ONE! Publishes your entire hierarchical structure to Arena PLM. Creates top-level assemblies, mid-level groupings, and individual configuration items with full BOMs. Includes pre-flight validation, automatic item creation for placeholders, and rollback protection. This is how you get everything into Arena.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Check All Status</div>
          <p class="menu-item-desc">Compares all your local configurations against Arena PLM to detect differences. Shows which are synced (green), modified locally (orange), or only exist in Arena (yellow). Helps you understand what needs to be updated before pushing changes.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">View History</div>
          <p class="menu-item-desc">Opens a filterable history log showing all events: configuration creations, BOM modifications, Arena sync events, and status changes. Perfect for auditing, troubleshooting, and understanding what happened when. Includes date filters and export capabilities.</p>
        </div>
      </div>

      <!-- Setup > Configuration Section -->
      <div class="menu-section">
        <h3><svg class="icon icon-md"><use href="#icon-settings"></use></svg>Setup ‚Üí Configuration</h3>

        <div class="menu-item">
          <div class="menu-item-title">Configure Arena Connection</div>
          <p class="menu-item-desc">Sets up your Arena PLM credentials (URL, email, password). This is REQUIRED before using any Arena features. Credentials are stored securely in Google's PropertiesService.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Test Connection</div>
          <p class="menu-item-desc">Validates your Arena credentials by making a test API call. Shows success/failure and helps troubleshoot connection issues. Run this after configuring credentials or if you're experiencing sync problems.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Clear Credentials</div>
          <p class="menu-item-desc">Removes stored Arena credentials from the system. Useful when switching Arena workspaces or troubleshooting authentication issues.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Configure Type System</div>
          <p class="menu-item-desc">THE CUSTOMIZATION CENTER! Configure entity terminology (what you call your main items), type classifications with keywords and colors, category classifications, layout grid settings, and hierarchy level names. Makes the tool work for ANY industry - data centers, manufacturing, warehouses, food service, etc.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Quick Setup (Default Config)</div>
          <p class="menu-item-desc">Applies a sensible default configuration if you don't want to customize everything. Good for getting started quickly or resetting to a known-good state.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Run Auto-Migration (Datacenter)</div>
          <p class="menu-item-desc">Converts legacy datacenter-specific configurations to the new generic Type System v2.0. Only needed if you were using an older version of this tool. Preserves all your data while upgrading to the flexible system.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Configure Item Columns</div>
          <p class="menu-item-desc">Customizes which Arena attributes appear as columns in configuration sheets. Show/hide item number, revision, description, category, lifecycle, and custom attributes. Lets you see exactly the data you need.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Configure Category Colors</div>
          <p class="menu-item-desc">Assigns colors to Arena categories for visual identification in your sheets. Makes it easy to spot different component types at a glance (e.g., Electrical = Yellow, Mechanical = Blue).</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Configure Configuration Colors</div>
          <p class="menu-item-desc">Assigns colors to your configuration types for visual identification. Works with the type classification system to color-code different configuration types in overview layouts and pickers.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Configure BOM Levels</div>
          <p class="menu-item-desc">Defines which Arena BOM levels to include when syncing. Some organizations use multi-level BOMs in Arena - this lets you control which levels get pulled into your configurations.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Location Propagation</div>
          <p class="menu-item-desc">Configures position/location tracking for components within hierarchies. When enabled, tracks which specific positions (e.g., "Pos 1, Pos 3, Pos 8") each component occupies. Essential for spatial tracking and location-aware BOMs.</p>
        </div>
      </div>

      <!-- Setup > Advanced Section -->
      <div class="menu-section">
        <h3>üîß Setup ‚Üí Advanced</h3>

        <div class="menu-item">
          <div class="menu-item-title">Mark Current as Synced</div>
          <p class="menu-item-desc">Manually marks the active configuration sheet as synced with Arena. Use with caution! This tells the system "this matches Arena" without actually checking. Useful for fixing status after manual fixes or import/export operations.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Validate History Integrity</div>
          <p class="menu-item-desc">Checks your history log for data integrity issues: missing required fields, invalid formats, orphaned records. Provides a detailed report of any problems found. Run this if history seems corrupted or you're seeing weird behavior.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Repair History Issues</div>
          <p class="menu-item-desc">Attempts to automatically fix problems found by validation. Removes invalid entries, fixes formatting issues, and rebuilds indexes. Always run validation first to see what will be fixed.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Export Configuration</div>
          <p class="menu-item-desc">Exports your complete Type System configuration to JSON format. Perfect for backing up settings, sharing configuration with team members, or migrating to a new spreadsheet. Includes all terminology, type definitions, colors, and settings.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Import Configuration</div>
          <p class="menu-item-desc">Imports a Type System configuration from JSON. Lets you restore from backup, apply a colleague's configuration, or set up a new spreadsheet to match existing standards. Validates the import before applying.</p>
        </div>

        <div class="menu-item">
          <div class="menu-item-title">Reset Configuration</div>
          <p class="menu-item-desc">Resets Type System configuration back to factory defaults. DESTRUCTIVE! This wipes all custom terminology, type definitions, and colors. Use when you want to start fresh or fix a badly corrupted configuration.</p>
        </div>
      </div>

      <!-- Help Section -->
      <div class="menu-section">
        <h3><svg class="icon icon-md"><use href="#icon-help"></use></svg>Help</h3>

        <div class="menu-item">
          <div class="menu-item-title">Help and Documentation</div>
          <p class="menu-item-desc">Opens this help guide! Comprehensive documentation covering getting started, configuration, workflows, menu reference, and more. Your complete reference for using the tool effectively.</p>
        </div>
      </div>

      <div class="tip-box">
        <strong>Pro Tip:</strong> Most workflows follow this pattern: <strong>Setup ‚Üí Design ‚Üí Review ‚Üí Publish</strong>. The menu is organized to support this natural progression!
      </div>

      <div class="info-box">
        <strong>Need Help?</strong> Each menu item is designed to work together. If you're unsure where to start, check the "Getting Started" tab for a step-by-step walkthrough, or use the workflow guide at the top of this page!
      </div>
    </div>

    <!-- Tab 3: Configuration -->
    <div class="tab-content">
      <h2>Configuration Setup</h2>

      <p>Before you start creating racks and layouts, let's configure Arena and customize the tool to match your workflow.</p>

      <h3>Menu Structure</h3>
      <p>The Arena menu is organized into logical sections:</p>
      <ul>
        <li><strong>Create Layout</strong> - Create new configurations and overview layouts</li>
        <li><strong>Show Item Picker / Configuration Picker</strong> - Browse and select Arena items</li>
        <li><strong>BOM Operations</strong> - Generate BOMs, push to Arena, check status, view history</li>
        <li><strong>Setup</strong> - Configuration settings and advanced tools</li>
        <li><strong>Help and Documentation</strong> - This help system</li>
      </ul>

      <h3>Configure Category Colors</h3>
      <p>Make your sheets more readable by assigning colors to Arena categories.</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Configure Category Colors</div>
      <p>This helps you visually identify different component types at a glance!</p>

      <h3>Configure Item Colors</h3>
      <p>Assign colors to different item types in your overview layouts.</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Configure Item Colors</div>
      <p>Makes it easy to distinguish different configuration types in your layout.</p>

      <h3>Configure BOM Levels</h3>
      <p>Set up which categories appear at which BOM levels (hierarchy).</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Configure BOM Levels</div>
      <p>This determines how items are organized in consolidated BOMs.</p>

      <h3>Configure Item Columns</h3>
      <p>Choose which Arena attributes to display as columns in your rack configurations.</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Configure Item Columns</div>
      <p>Customize what information you see for each component.</p>

      <h3>BOM Location Propagation</h3>
      <p>Enable automatic position tracking for items in BOM hierarchies - similar to reference designators for electrical components.</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí BOM Location Setting</div>

      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Create BOM attribute in Arena first</strong>
        <ul>
          <li>In Arena, go to Settings ‚Üí BOM Attributes (or Item Attributes)</li>
          <li>Create a new attribute (e.g., "Item Positions")</li>
          <li>Type: <code>SINGLE_LINE_TEXT</code></li>
          <li>Apply to categories that will have BOMs</li>
        </ul>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Configure in the spreadsheet</strong>
        <ul>
          <li>Open the Rack Location Propagation configuration dialog</li>
          <li>Select your Arena BOM attribute from the dropdown</li>
          <li>Optionally adjust the position format (default: "Pos {n}")</li>
          <li>Click Save</li>
        </ul>
      </div>

      <p><strong>What this does:</strong> When you push a structure to Arena, each item on a parent's BOM will be automatically tagged with its specific positions.</p>

      <p><strong>Example:</strong> If an item appears in Pos 1, Pos 3, and Pos 8, the BOM line will have the position attribute set to "Pos 1, Pos 3, Pos 8"</p>

      <div class="tip-box">
        <strong>Pro Tip:</strong> This feature is optional! To disable it, select "No position tracking (disabled)" in the configuration dialog.
      </div>
    </div>

    <!-- Tab 3: Creating Content -->
    <div class="tab-content">
      <h2>Creating Racks and Layouts</h2>

      <p>Now for the fun part! Let's build some rack configurations and design your data center layout.</p>

      <h3>Option A: Use Existing Racks from Arena</h3>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Open Rack Picker</strong>
        <div class="menu-path">Arena ‚Üí Show Rack Picker</div>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Browse and filter racks</strong>
        <p>Use category filters, search, and favorites to find the rack you want.</p>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Select a rack</strong>
        <p>Click on a rack card to select it, then click a cell in your overview to place it.</p>
      </div>

      <h3>Option B: Create Custom Rack Configurations</h3>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Create new rack configuration</strong>
        <div class="menu-path">Arena ‚Üí Create Layout ‚Üí New Rack Configuration</div>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Name your rack</strong>
        <p>You can link to an existing Arena item or create a placeholder for later.</p>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Add components using Item Picker</strong>
        <div class="menu-path">Arena ‚Üí Show Item Picker</div>
        <p>Browse Arena items, select components, and click rows to add them to your rack BOM.</p>
      </div>

      <div class="tip-box">
        <strong>Tip:</strong> Use favorites in Item Picker to quickly access your most-used categories and components!
      </div>

      <h3>Option C: Clone or Load Templates</h3>
      <p>Save time by cloning existing racks or loading Arena items as templates! Perfect for creating variants or using the "150% BOM" approach.</p>

      <div class="info-box" style="margin-bottom: 20px;">
        <strong>üí° What is the "150% BOM" Workflow?</strong>
        <p>Load a comprehensive Arena item containing ALL possible options (e.g., 50 component variants), then trim it down to your actual needs (15 components). This is faster than adding components one-by-one!</p>
      </div>

      <h4>Clone Existing Rack</h4>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Open Rack Picker Templates Tab</strong>
        <div class="menu-path">Arena ‚Üí Show Rack Picker ‚Üí Templates Tab</div>
        <p>Or use: <span class="menu-path">Arena ‚Üí Create Layout ‚Üí Clone Existing Rack</span></p>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Find rack to clone</strong>
        <p>Browse existing racks or use the search box to find "Server Type A". Click the <strong>clone icon ‚ßâ</strong> next to the rack name.</p>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Enter new rack details</strong>
        <p>Provide a new rack number and name (e.g., "Type B"). The clone modal shows you how many components will be copied.</p>
      </div>

      <div class="step-box">
        <span class="step-number">4</span>
        <strong>Edit the cloned rack</strong>
        <p>New rack is created as <strong>PLACEHOLDER</strong> (red status). Modify components as needed, then push to Arena when ready.</p>
      </div>

      <h4>Load Arena Template (150% BOM)</h4>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Switch to Arena Template mode</strong>
        <div class="menu-path">Rack Picker ‚Üí Templates Tab ‚Üí Arena Template</div>
        <p>Or use: <span class="menu-path">Arena ‚Üí Create Layout ‚Üí Load Arena Item as Template</span></p>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Search for comprehensive item</strong>
        <p>Find an Arena item with ALL component options (e.g., "SERVER-ALL-OPTIONS" with 50 components including 5 storage options, 5 RAM types, etc.)</p>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Preview BOM before loading</strong>
        <p>Click "Load as Template" to see a preview showing component count and categories. Click "Confirm" to create the rack.</p>
      </div>

      <div class="step-box">
        <span class="step-number">4</span>
        <strong>Trim down to desired config</strong>
        <p>Delete unwanted rows (35 of 50), keeping only what you need (15 components). Then push to Arena as your custom configuration.</p>
      </div>

      <div class="tip-box">
        <strong>Quick Clone Tip:</strong> When viewing a rack sheet, use <span class="menu-path">Arena ‚Üí Create Layout ‚Üí Clone This Rack</span> for instant duplication!
      </div>

      <h3>BOM Tree Viewer - Add Components Intelligently</h3>
      <p>Browse Arena BOMs in a hierarchical tree view and selectively insert components into your rack configurations.</p>

      <h4>Opening the BOM Tree</h4>
      <p>From Item Picker or Rack Picker, click the <strong>tree icon üå≥</strong> next to any item to view its complete BOM structure.</p>

      <h4>Key Features</h4>
      <ul>
        <li><strong>Hierarchical View:</strong> Expand/collapse nodes to explore multi-level BOMs (up to 10 levels deep)</li>
        <li><strong>Selective Insert:</strong> Check boxes next to components you want, then click "Insert Selected"</li>
        <li><strong>Resizable Columns:</strong> Drag column dividers to resize Item Number, Name, Qty, Revision, Description</li>
        <li><strong>Custom Attributes:</strong> Add Arena attribute columns like "Power Consumption", "U Spaces", "Geo Usage" (see below)</li>
        <li><strong>Fast Performance:</strong> Optimized to load BOMs in 3-5 seconds without extra API calls</li>
      </ul>

      <h4>Using Custom Attribute Columns</h4>
      <p>Display Arena custom attributes as columns to make better component selection decisions:</p>

      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Configure available attributes</strong>
        <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Configure BOM Tree Columns</div>
        <p>Click "Load Available Attributes" to see all 85+ custom attributes defined in your Arena workspace.</p>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Search and select attributes</strong>
        <p>Use the search box to find attributes like "power", "spaces", or "weight". Check the boxes for attributes you want as columns.</p>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Save configuration</strong>
        <p>Click "Save Configuration". Your selected attributes (e.g., Power Consumption, U Spaces Required) now appear as columns in the BOM Tree viewer.</p>
      </div>

      <div class="step-box">
        <span class="step-number">4</span>
        <strong>View attributes in BOM Tree</strong>
        <p>Open any BOM Tree - your custom columns appear after the default columns. Values are lazy-loaded and cached for performance.</p>
      </div>

      <div class="info-box">
        <strong>Performance Note:</strong> Attribute values are fetched only for <em>visible</em> nodes and cached for 1 hour. This keeps the BOM Tree fast even with many custom columns!
      </div>

      <div class="tip-box">
        <strong>Use Cases:</strong>
        <ul style="margin-top: 8px;">
          <li><strong>Power Planning:</strong> Add "Power Consumption (W)" to calculate total rack power</li>
          <li><strong>Space Planning:</strong> Add "U Spaces Required" to ensure components fit</li>
          <li><strong>Compliance:</strong> Add "Geo Usage" to filter components by region</li>
          <li><strong>Lifecycle:</strong> Add custom lifecycle fields to track component phases</li>
        </ul>
      </div>

      <h3>Creating an Overview Layout</h3>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Create new overview layout</strong>
        <div class="menu-path">Arena ‚Üí Create Layout ‚Üí New Overview Layout</div>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Specify dimensions</strong>
        <p>Set the number of rows and positions (columns) for your data center layout.</p>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Place racks in the grid</strong>
        <p>Use Rack Picker to select and place racks in your layout positions.</p>
      </div>

      <h3>Auto-Linking Racks to Overview</h3>
      <p>Automatically populate your overview with rack configurations already in your spreadsheet:</p>
      <div class="menu-path">Arena ‚Üí Create Layout ‚Üí Autolink Racks to Overview</div>
      <p>This saves time when you have multiple rack sheets and want to quickly build a layout!</p>

      <h3>Generate Consolidated BOM</h3>
      <p>Once your layout is complete, generate a consolidated BOM to see all materials:</p>
      <div class="menu-path">Arena ‚Üí BOM Operations ‚Üí Create Consolidated BOM</div>
      <p>This creates a new sheet showing all components with aggregated quantities across all racks!</p>
    </div>

    <!-- Tab 4: Status & History -->
    <div class="tab-content">
      <h2>Status Tracking & History Management</h2>

      <p>The Arena Data Center tool provides comprehensive status tracking and history logging for all your rack configurations.</p>

      <h3>Understanding Status Indicators</h3>
      <p>Each rack tab displays an emoji indicator showing its current sync status with Arena:</p>

      <div style="margin: 20px 0;">
        <div class="status-indicator status-synced">üü¢ SYNCED - Matches Arena exactly</div>
        <div class="status-indicator status-arena">üü° ARENA_MODIFIED - Arena has changes not yet pulled</div>
        <div class="status-indicator status-local">üü† LOCAL_MODIFIED - Sheet has local edits not pushed to Arena</div>
        <div class="status-indicator status-placeholder">üî¥ PLACEHOLDER - Created locally, not yet in Arena</div>
        <div class="status-indicator status-error"><svg class="icon icon-sm"><use href="#icon-close"></use></svg>ERROR - Last sync operation failed</div>
      </div>

      <h3>Checking Rack Status</h3>
      <p>To check the sync status of all racks against Arena:</p>
      <div class="menu-path">Arena ‚Üí BOM Operations ‚Üí Check all Rack Status (vs. PDM)</div>

      <p>This will:</p>
      <ul>
        <li>Check each rack's BOM against Arena</li>
        <li>Update tab indicators automatically</li>
        <li>Show a summary of rack counts by status</li>
        <li>Log the check event to History tab</li>
      </ul>

      <div class="info-box">
        <strong>Smart Detection:</strong> The system can distinguish between local edits (you changed the sheet) and Arena changes (someone updated Arena) by comparing BOM checksums.
      </div>

      <h3>Viewing Rack History</h3>
      <p>Access the centralized history tracking system:</p>
      <div class="menu-path">Arena ‚Üí BOM Operations ‚Üí View Rack History</div>

      <p>The History tab provides:</p>
      <ul>
        <li><strong>Summary Section:</strong> Current status of all racks at a glance</li>
        <li><strong>Detail Section:</strong> Chronological log of all events</li>
        <li><strong>Filter Sidebar:</strong> Automatically opens to help you navigate</li>
        <li><strong>Quick Stats:</strong> Count of racks by status</li>
      </ul>

      <h3>Using the History Filter</h3>
      <p>The filter sidebar (auto-opens when viewing History tab) lets you:</p>
      <ol>
        <li>Select a specific rack from the dropdown</li>
        <li>Click "Apply Filter" to show only that rack's events</li>
        <li>Click "Clear Filter" to show all events</li>
        <li>View quick stats showing rack counts by status</li>
      </ol>

      <div class="tip-box">
        <strong>Navigation Tip:</strong> Click the "<svg class="icon icon-sm"><use href="#icon-history"></use></svg>History" link in any rack sheet (cell D1) to jump directly to the History tab filtered for that rack!
      </div>

      <h3>Event Types Logged</h3>
      <p>The History tab records the following events:</p>
      <ul>
        <li><strong>Rack Created</strong> - New rack configuration created</li>
        <li><strong>Status Change</strong> - Rack sync status updated</li>
        <li><strong>Local Edit</strong> - User edited rack BOM</li>
        <li><strong>Refresh Accepted/Declined</strong> - Arena BOM refresh decision</li>
        <li><strong>POD Push</strong> - Rack included in push to Arena</li>
        <li><strong>BOM Pull</strong> - BOM pulled from Arena</li>
        <li><strong>Manual Sync</strong> - User manually marked as synced</li>
        <li><strong>Batch Check</strong> - Status check operation</li>
        <li><strong>Error</strong> - Operation failed</li>
      </ul>

      <h3>Handling Out-of-Sync Racks</h3>
      <p>When a rack shows üü° (Arena Modified):</p>
      <ol>
        <li>Open the rack sheet</li>
        <li>Right-click to access "Refresh BOM from Arena"</li>
        <li>Review the proposed changes in the diff dialog</li>
        <li>Accept to sync with Arena or decline to keep current BOM</li>
        <li>Status updates to üü¢ SYNCED if you accept</li>
      </ol>

      <h3>Advanced Status Tools</h3>
      <p>Power users can access advanced tools:</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Advanced</div>

      <ul>
        <li><strong>Mark Current Rack as Synced:</strong> Manually override status (use with caution!)</li>
        <li><strong>Validate History Integrity:</strong> Check for missing/orphaned/invalid data</li>
        <li><strong>Repair History Issues:</strong> Auto-fix common problems</li>
      </ul>

      <div class="warning-box">
        <strong>Protected Data:</strong> The History tab is protected from manual editing to maintain data integrity. All updates are made automatically by the system.
      </div>
    </div>

    <!-- Tab 5: Publishing -->
    <div class="tab-content">
      <h2>Publishing to Arena</h2>

      <p>Ready to push your data center design to Arena? The "Push BOMs to Arena" feature creates a complete hierarchy in Arena.</p>

      <h3>Understanding the POD Structure</h3>
      <p>The system creates a three-level hierarchy in Arena:</p>
      <ul>
        <li><strong>POD (Point of Delivery):</strong> The top-level item representing your entire data center or section</li>
        <li><strong>Row Items:</strong> One for each row in your overview, with Row Location attribute tracking positions</li>
        <li><strong>Rack Items:</strong> Individual racks with their component BOMs</li>
      </ul>

      <h3>The Publishing Workflow</h3>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Start the publish process</strong>
        <div class="menu-path">Arena ‚Üí BOM Operations ‚Üí Push BOMs to Arena</div>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Pre-flight validation</strong>
        <p>The system performs extensive validation before making any changes to Arena:</p>
        <ul>
          <li>Checks all rack configurations are valid</li>
          <li>Verifies all Arena items exist</li>
          <li>Validates BOM structure integrity</li>
          <li>Shows preview of what will be created/updated</li>
        </ul>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Review and confirm</strong>
        <p>Review the validation results and choose to proceed or cancel.</p>
      </div>

      <div class="step-box">
        <span class="step-number">4</span>
        <strong>Custom rack creation (if needed)</strong>
        <p>If you have PLACEHOLDER racks not yet in Arena, you'll be prompted to:</p>
        <ul>
          <li>Provide rack name and description</li>
          <li>Select Arena category</li>
          <li>Set lifecycle phase</li>
        </ul>
        <p>The system will create the Arena item and populate its BOM automatically!</p>
      </div>

      <div class="step-box">
        <span class="step-number">5</span>
        <strong>Choose: Update or Create New</strong>
        <p>Decide whether to update existing POD/Row items or create fresh ones.</p>
      </div>

      <div class="step-box">
        <span class="step-number">6</span>
        <strong>Name your items</strong>
        <p>Provide names for Row items and the POD (e.g., "North Row A", "Data Center Pod A")</p>
      </div>

      <div class="step-box">
        <span class="step-number">7</span>
        <strong>Rollback protection</strong>
        <p>If any errors occur during the push, the system can automatically rollback changes to maintain data integrity.</p>
      </div>

      <div class="step-box">
        <span class="step-number">8</span>
        <strong>Success!</strong>
        <p>Your overview sheet is updated with:</p>
        <ul>
          <li>POD information at the top with Arena link</li>
          <li>Row Item column with links to each row in Arena</li>
          <li>Rack status indicators updated to üü¢ SYNCED</li>
          <li>History events logged for audit trail</li>
        </ul>
      </div>

      <h3>What Gets Created in Arena</h3>
      <ul>
        <li><strong>Placeholder Rack Items:</strong> Created with full BOMs from your configurations</li>
        <li><strong>Row Items:</strong> Each with "Row Location" attribute (e.g., "Pos 1, Pos 3, Pos 5") and BOM showing all racks with correct quantities</li>
        <li><strong>Rack Position Tracking (if configured):</strong> Each rack on a Row's BOM is tagged with its specific positions (e.g., "Pos 1, Pos 3, Pos 8")</li>
        <li><strong>POD Item:</strong> Top-level assembly containing all rows</li>
      </ul>

      <div class="info-box">
        <strong>New Features:</strong> The latest version includes pre-flight validation, rollback support, and comprehensive error handling to ensure safe Arena updates!
      </div>

      <div class="warning-box">
        <strong>Note:</strong> The system creates Arena items in the correct order:
        <ol>
          <li>Placeholder racks first (so they exist for row BOMs)</li>
          <li>Then row items (so they exist for POD BOM)</li>
          <li>Finally the POD item at the top</li>
        </ol>
      </div>

      <div class="tip-box">
        <strong>Pro Tip:</strong> After publishing, click the Arena links in your overview sheet to jump directly to those items in Arena PLM!
      </div>

      <h3>Need Help?</h3>
      <p>If you run into any issues:</p>
      <ul>
        <li>Check that your Arena connection is working</li>
        <li>Review the validation results carefully</li>
        <li>Check the Apps Script logs for detailed error messages</li>
        <li>Use "Validate History Integrity" to check for data issues</li>
        <li>Verify all rack configurations have valid Arena items</li>
      </ul>
    </div>

    <!-- Tab 6: About -->
    <div class="tab-content">
      <h2>About This Tool</h2>

      <div class="creator-card">
        <img class="creator-photo" src="https://media.licdn.com/dms/image/v2/D5603AQFVGXhMJl_YOQ/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1708455515046?e=1742428800&v=beta&t=xQJxMJKxF7zDxP0FJKxJ0MJKxF7zDxP0FJKxJ0MJKxF"
             alt="Dan Bacon"
             onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 200 200%22%3E%3Ccircle cx=%22100%22 cy=%22100%22 r=%22100%22 fill=%22%231a73e8%22/%3E%3Ctext x=%22100%22 y=%22115%22 font-size=%2280%22 text-anchor=%22middle%22 fill=%22white%22 font-family=%22Arial%22%3EDB%3C/text%3E%3C/svg%3E'">

        <h3 class="creator-name">Dan Bacon</h3>
        <p class="creator-title">PTC Arena PLM</p>

        <div class="creator-message">
          <p>This tool was built to make Arena PLM integration seamless and powerful. Whether you're managing data center infrastructure, manufacturing assemblies, or any hierarchical product structure, this tool helps you design, track, and sync everything with Arena.</p>

          <p>If you find this tool helpful or have ideas for improvements, I'd love to hear from you!</p>
        </div>

        <a href="https://www.linkedin.com/in/thedanielbacon" target="_blank" class="linkedin-button">
          Connect on LinkedIn
        </a>
      </div>

      <div class="info-box" style="text-align: center;">
        <strong>Open Source & Collaboration</strong>
        <p style="margin-top: 10px;">This project is built with Google Apps Script and integrates with Arena PLM's REST API. Interested in contributing or have questions? Reach out on LinkedIn!</p>
      </div>

      <div class="tip-box" style="text-align: center;">
        <strong>Made with</strong> <svg class="icon icon-sm"><use href="#icon-tool"></use></svg>Google Apps Script ‚Ä¢ <svg class="icon icon-sm"><use href="#icon-link"></use></svg>Arena PLM API ‚Ä¢ <svg class="icon icon-sm"><use href="#icon-heart"></use></svg>Passion for great tools
      </div>
    </div>
  </div>

  <script>
    var terminology = {
      entity_singular: 'Configuration',
      entity_plural: 'Configurations',
      entity_singular_lower: 'configuration',
      entity_plural_lower: 'configurations',
      hierarchy_level_0: 'Assembly',
      hierarchy_level_1: 'SubAssembly',
      hierarchy_level_2: 'Configuration'
    };

    // Load terminology from backend
    google.script.run
      .withSuccessHandler(function(terms) {
        terminology = terms;
        updateContentWithTerminology();
      })
      .withFailureHandler(function(error) {
        console.log('Using default terminology:', error);
        updateContentWithTerminology();
      })
      .getTerminologyForUI();

    function updateContentWithTerminology() {
      var entity = terminology.entity_singular;
      var entityLower = terminology.entity_singular_lower;
      var entityPlural = terminology.entity_plural;
      var entityPluralLower = terminology.entity_plural_lower;
      var level0 = terminology.hierarchy_level_0;
      var level1 = terminology.hierarchy_level_1;
      var level2 = terminology.hierarchy_level_2;

      // Update header
      document.getElementById('headerTitle').textContent = 'Arena ' + entity + ' Manager - Help Guide';
      document.getElementById('headerSubtitle').textContent = 'Your complete guide to managing ' + entityPluralLower + ' with Arena PLM';

      // Replace terminology throughout the document
      replacePlaceholders();
    }

    function replacePlaceholders() {
      // Get all text nodes and replace placeholders
      var walker = document.createTreeWalker(
        document.body,
        NodeFilter.SHOW_TEXT,
        null,
        false
      );

      var nodesToReplace = [];
      var node;

      while (node = walker.nextNode()) {
        if (node.nodeValue.match(/\b(rack|racks|Rack|Racks|RACK|data center|datacenter|Data Center|POD|Row|point of delivery)\b/i)) {
          nodesToReplace.push(node);
        }
      }

      // Perform replacements
      nodesToReplace.forEach(function(textNode) {
        var text = textNode.nodeValue;

        // Replace terminology
        text = text.replace(/\bdata center\b/gi, terminology.entity_singular_lower + ' infrastructure');
        text = text.replace(/\bRack\b(?![ -])/g, terminology.entity_singular);
        text = text.replace(/\bracks\b/g, terminology.entity_plural_lower);
        text = text.replace(/\bRacks\b/g, terminology.entity_plural);
        text = text.replace(/\brack\b/gi, terminology.entity_singular_lower);
        text = text.replace(/\bPOD\b/g, terminology.hierarchy_level_0);
        text = text.replace(/\bRow\b(?![ ]Location)/g, terminology.hierarchy_level_1);
        text = text.replace(/\bPoint of Delivery\b/gi, terminology.hierarchy_level_0);

        textNode.nodeValue = text;
      });
    }

    function showTab(index) {
      // Hide all tabs and content
      var tabs = document.getElementsByClassName('tab');
      var contents = document.getElementsByClassName('tab-content');

      for (var i = 0; i < tabs.length; i++) {
        tabs[i].classList.remove('active');
        contents[i].classList.remove('active');
      }

      // Show selected tab and content
      tabs[index].classList.add('active');
      contents[index].classList.add('active');
    }
  </script>
</body>
</html>
