<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body {
      font-family: 'Google Sans', Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f8f9fa;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      min-height: 100vh;
    }

    .header {
      background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%);
      color: white;
      padding: 40px 30px;
      text-align: center;
    }

    .header h1 {
      margin: 0;
      font-size: 32px;
      font-weight: 500;
    }

    .header p {
      margin: 12px 0 0 0;
      color: white;
      opacity: 0.95;
      font-size: 16px;
      font-weight: 400;
    }

    .tabs {
      display: flex;
      background: #fff;
      border-bottom: 2px solid #dadce0;
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 4px rgba(0,0,0,0.08);
    }

    .tab {
      flex: 1;
      padding: 16px 20px;
      text-align: center;
      cursor: pointer;
      border: none;
      background: none;
      font-size: 14px;
      font-weight: 500;
      color: #5f6368;
      transition: all 0.2s ease;
      border-bottom: 3px solid transparent;
    }

    .tab:hover {
      background: #f8f9fa;
      color: #202124;
    }

    .tab.active {
      color: #1a73e8;
      border-bottom-color: #1a73e8;
      background: #e8f0fe;
    }

    .tab-content {
      display: none;
      padding: 40px 30px;
      animation: fadeIn 0.3s ease;
    }

    .tab-content.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    h2 {
      color: #202124;
      font-size: 28px;
      margin-top: 0;
      margin-bottom: 24px;
      border-bottom: 3px solid #1a73e8;
      padding-bottom: 12px;
      font-weight: 500;
    }

    h3 {
      color: #202124;
      font-size: 20px;
      margin-top: 32px;
      margin-bottom: 16px;
      font-weight: 500;
    }

    p {
      color: #5f6368;
      line-height: 1.7;
      margin-bottom: 16px;
      font-size: 15px;
    }

    .step-box {
      background: #e8f0fe;
      border-left: 4px solid #1a73e8;
      padding: 20px 24px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .step-number {
      display: inline-block;
      background: #1a73e8;
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      text-align: center;
      line-height: 32px;
      font-weight: 500;
      margin-right: 12px;
      font-size: 16px;
    }

    .warning-box {
      background: #fef7e0;
      border-left: 4px solid #f9ab00;
      padding: 20px 24px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .warning-box strong {
      color: #b06000;
    }

    .tip-box {
      background: #e6f4ea;
      border-left: 4px solid #34a853;
      padding: 20px 24px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .tip-box strong {
      color: #137333;
    }

    .info-box {
      background: #e8f0fe;
      border-left: 4px solid #1a73e8;
      padding: 20px 24px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .info-box strong {
      color: #1967d2;
    }

    ul {
      color: #5f6368;
      line-height: 1.8;
      margin-left: 20px;
      font-size: 15px;
    }

    ol {
      color: #5f6368;
      line-height: 1.8;
      margin-left: 20px;
      font-size: 15px;
    }

    code {
      background: #f1f3f4;
      padding: 3px 8px;
      border-radius: 4px;
      font-family: 'Roboto Mono', 'Courier New', monospace;
      color: #d93025;
      font-size: 14px;
    }

    .menu-path {
      background: #e8f0fe;
      padding: 12px 16px;
      border-radius: 4px;
      font-family: 'Roboto Mono', 'Courier New', monospace;
      font-size: 13px;
      color: #1967d2;
      margin: 12px 0;
      border: 1px solid #d2e3fc;
    }

    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 16px;
      margin: 24px 0;
    }

    .feature-card {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      border: 1px solid #dadce0;
      transition: all 0.2s;
    }

    .feature-card:hover {
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      border-color: #1a73e8;
    }

    .feature-card h4 {
      margin: 0 0 10px 0;
      color: #1a73e8;
      font-size: 17px;
      font-weight: 500;
    }

    .feature-card p {
      margin: 0;
      font-size: 14px;
      color: #5f6368;
    }

    .status-indicator {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 4px;
      font-size: 14px;
      font-weight: 500;
      margin: 4px;
    }

    .status-synced {
      background: #e6f4ea;
      color: #137333;
    }

    .status-arena {
      background: #fef7e0;
      color: #b06000;
    }

    .status-local {
      background: #fce8e6;
      color: #c5221f;
    }

    .status-placeholder {
      background: #fce8e6;
      color: #c5221f;
    }

    .status-error {
      background: #fce8e6;
      color: #c5221f;
    }

    /* About / Creator Section */
    .creator-card {
      background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
      border: 2px solid #dadce0;
      border-radius: 12px;
      padding: 40px;
      margin: 40px auto;
      max-width: 600px;
      text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .creator-photo {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      margin: 0 auto 24px;
      border: 4px solid #1a73e8;
      box-shadow: 0 4px 12px rgba(26, 115, 232, 0.2);
    }

    .creator-name {
      font-size: 28px;
      font-weight: 500;
      color: #202124;
      margin: 0 0 8px 0;
    }

    .creator-title {
      font-size: 18px;
      color: #5f6368;
      margin: 0 0 24px 0;
    }

    .creator-message {
      font-size: 16px;
      color: #5f6368;
      line-height: 1.7;
      margin: 24px 0;
    }

    .linkedin-button {
      display: inline-block;
      background: #0077b5;
      color: white;
      padding: 14px 32px;
      border-radius: 8px;
      text-decoration: none;
      font-size: 16px;
      font-weight: 500;
      margin-top: 20px;
      transition: all 0.2s;
      box-shadow: 0 2px 8px rgba(0, 119, 181, 0.3);
    }

    .linkedin-button:hover {
      background: #006399;
      box-shadow: 0 4px 12px rgba(0, 119, 181, 0.4);
      transform: translateY(-2px);
    }

    .linkedin-button:before {
      content: "in";
      display: inline-block;
      background: white;
      color: #0077b5;
      width: 24px;
      height: 24px;
      line-height: 24px;
      border-radius: 3px;
      font-weight: bold;
      margin-right: 10px;
      font-size: 18px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1 id="headerTitle">Arena PLM Integration - Help Guide</h1>
      <p id="headerSubtitle">Your complete guide to managing configurations with Arena PLM</p>
    </div>

    <div class="tabs">
      <button class="tab active" onclick="showTab(0)">Getting Started</button>
      <button class="tab" onclick="showTab(1)">Configuration</button>
      <button class="tab" onclick="showTab(2)">Creating Content</button>
      <button class="tab" onclick="showTab(3)">Status & History</button>
      <button class="tab" onclick="showTab(4)">Publishing</button>
      <button class="tab" onclick="showTab(5)">About</button>
    </div>

    <!-- Tab 1: Getting Started -->
    <div class="tab-content active">
      <h2>Welcome! Let's Get You Started</h2>

      <p>Welcome! This tool helps you design layouts, manage configurations, and sync everything with Arena PLM. Let's get you up and running!</p>

      <h3>Step 1: Connect to Arena</h3>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Open the configuration menu</strong>
        <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Configure Arena Connection</div>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Enter your Arena credentials</strong>
        <ul>
          <li><strong>Arena URL:</strong> Your Arena workspace URL (e.g., https://yourcompany.arenasolutions.com)</li>
          <li><strong>Email:</strong> Your Arena login email</li>
          <li><strong>Password:</strong> Your Arena password</li>
          <li><strong>Workspace ID:</strong> Your Arena workspace ID (found in Arena settings)</li>
        </ul>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Test the connection</strong>
        <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Test Connection</div>
        <p>Verify everything is working correctly before proceeding.</p>
      </div>

      <div class="tip-box">
        <strong>Pro Tip:</strong> Your credentials are stored securely in Google's property service and are only accessible by this spreadsheet.
      </div>

      <h3>What This Tool Does</h3>
      <div class="feature-grid">
        <div class="feature-card">
          <h4>Configuration Management</h4>
          <p>Create and configure item BOMs with components from Arena</p>
        </div>
        <div class="feature-card">
          <h4>Layout Design</h4>
          <p>Design layouts with visual item placement in grid positions</p>
        </div>
        <div class="feature-card">
          <h4>BOM Automation</h4>
          <p>Automatically generate consolidated BOMs from your layouts</p>
        </div>
        <div class="feature-card">
          <h4>Arena Sync</h4>
          <p>Push hierarchical structures directly to Arena PLM</p>
        </div>
        <div class="feature-card">
          <h4>Status Tracking</h4>
          <p>Visual indicators show sync status for all configurations</p>
        </div>
        <div class="feature-card">
          <h4>History Logging</h4>
          <p>Complete audit trail of all changes and events</p>
        </div>
      </div>
    </div>

    <!-- Tab 2: Configuration -->
    <div class="tab-content">
      <h2>Configuration Setup</h2>

      <p>Before you start creating racks and layouts, let's configure Arena and customize the tool to match your workflow.</p>

      <h3>Menu Structure</h3>
      <p>The Arena menu is organized into logical sections:</p>
      <ul>
        <li><strong>Create Layout</strong> - Create new configurations and overview layouts</li>
        <li><strong>Show Item Picker / Configuration Picker</strong> - Browse and select Arena items</li>
        <li><strong>BOM Operations</strong> - Generate BOMs, push to Arena, check status, view history</li>
        <li><strong>Setup</strong> - Configuration settings and advanced tools</li>
        <li><strong>Help and Documentation</strong> - This help system</li>
      </ul>

      <h3>Configure Category Colors</h3>
      <p>Make your sheets more readable by assigning colors to Arena categories.</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Configure Category Colors</div>
      <p>This helps you visually identify different component types at a glance!</p>

      <h3>Configure Item Colors</h3>
      <p>Assign colors to different item types in your overview layouts.</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Configure Item Colors</div>
      <p>Makes it easy to distinguish different configuration types in your layout.</p>

      <h3>Configure BOM Levels</h3>
      <p>Set up which categories appear at which BOM levels (hierarchy).</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Configure BOM Levels</div>
      <p>This determines how items are organized in consolidated BOMs.</p>

      <h3>Configure Item Columns</h3>
      <p>Choose which Arena attributes to display as columns in your rack configurations.</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí Configure Item Columns</div>
      <p>Customize what information you see for each component.</p>

      <h3>BOM Location Propagation</h3>
      <p>Enable automatic position tracking for items in BOM hierarchies - similar to reference designators for electrical components.</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Configuration ‚Üí BOM Location Setting</div>

      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Create BOM attribute in Arena first</strong>
        <ul>
          <li>In Arena, go to Settings ‚Üí BOM Attributes (or Item Attributes)</li>
          <li>Create a new attribute (e.g., "Item Positions")</li>
          <li>Type: <code>SINGLE_LINE_TEXT</code></li>
          <li>Apply to categories that will have BOMs</li>
        </ul>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Configure in the spreadsheet</strong>
        <ul>
          <li>Open the Rack Location Propagation configuration dialog</li>
          <li>Select your Arena BOM attribute from the dropdown</li>
          <li>Optionally adjust the position format (default: "Pos {n}")</li>
          <li>Click Save</li>
        </ul>
      </div>

      <p><strong>What this does:</strong> When you push a structure to Arena, each item on a parent's BOM will be automatically tagged with its specific positions.</p>

      <p><strong>Example:</strong> If an item appears in Pos 1, Pos 3, and Pos 8, the BOM line will have the position attribute set to "Pos 1, Pos 3, Pos 8"</p>

      <div class="tip-box">
        <strong>Pro Tip:</strong> This feature is optional! To disable it, select "No position tracking (disabled)" in the configuration dialog.
      </div>
    </div>

    <!-- Tab 3: Creating Content -->
    <div class="tab-content">
      <h2>Creating Racks and Layouts</h2>

      <p>Now for the fun part! Let's build some rack configurations and design your data center layout.</p>

      <h3>Option A: Use Existing Racks from Arena</h3>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Open Rack Picker</strong>
        <div class="menu-path">Arena ‚Üí Show Rack Picker</div>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Browse and filter racks</strong>
        <p>Use category filters, search, and favorites to find the rack you want.</p>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Select a rack</strong>
        <p>Click on a rack card to select it, then click a cell in your overview to place it.</p>
      </div>

      <h3>Option B: Create Custom Rack Configurations</h3>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Create new rack configuration</strong>
        <div class="menu-path">Arena ‚Üí Create Layout ‚Üí New Rack Configuration</div>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Name your rack</strong>
        <p>You can link to an existing Arena item or create a placeholder for later.</p>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Add components using Item Picker</strong>
        <div class="menu-path">Arena ‚Üí Show Item Picker</div>
        <p>Browse Arena items, select components, and click rows to add them to your rack BOM.</p>
      </div>

      <div class="tip-box">
        <strong>Tip:</strong> Use favorites in Item Picker to quickly access your most-used categories and components!
      </div>

      <h3>Creating an Overview Layout</h3>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Create new overview layout</strong>
        <div class="menu-path">Arena ‚Üí Create Layout ‚Üí New Overview Layout</div>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Specify dimensions</strong>
        <p>Set the number of rows and positions (columns) for your data center layout.</p>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Place racks in the grid</strong>
        <p>Use Rack Picker to select and place racks in your layout positions.</p>
      </div>

      <h3>Auto-Linking Racks to Overview</h3>
      <p>Automatically populate your overview with rack configurations already in your spreadsheet:</p>
      <div class="menu-path">Arena ‚Üí Create Layout ‚Üí Autolink Racks to Overview</div>
      <p>This saves time when you have multiple rack sheets and want to quickly build a layout!</p>

      <h3>Generate Consolidated BOM</h3>
      <p>Once your layout is complete, generate a consolidated BOM to see all materials:</p>
      <div class="menu-path">Arena ‚Üí BOM Operations ‚Üí Create Consolidated BOM</div>
      <p>This creates a new sheet showing all components with aggregated quantities across all racks!</p>
    </div>

    <!-- Tab 4: Status & History -->
    <div class="tab-content">
      <h2>Status Tracking & History Management</h2>

      <p>The Arena Data Center tool provides comprehensive status tracking and history logging for all your rack configurations.</p>

      <h3>Understanding Status Indicators</h3>
      <p>Each rack tab displays an emoji indicator showing its current sync status with Arena:</p>

      <div style="margin: 20px 0;">
        <div class="status-indicator status-synced">üü¢ SYNCED - Matches Arena exactly</div>
        <div class="status-indicator status-arena">üü° ARENA_MODIFIED - Arena has changes not yet pulled</div>
        <div class="status-indicator status-local">üü† LOCAL_MODIFIED - Sheet has local edits not pushed to Arena</div>
        <div class="status-indicator status-placeholder">üî¥ PLACEHOLDER - Created locally, not yet in Arena</div>
        <div class="status-indicator status-error">‚ùå ERROR - Last sync operation failed</div>
      </div>

      <h3>Checking Rack Status</h3>
      <p>To check the sync status of all racks against Arena:</p>
      <div class="menu-path">Arena ‚Üí BOM Operations ‚Üí Check all Rack Status (vs. PDM)</div>

      <p>This will:</p>
      <ul>
        <li>Check each rack's BOM against Arena</li>
        <li>Update tab indicators automatically</li>
        <li>Show a summary of rack counts by status</li>
        <li>Log the check event to History tab</li>
      </ul>

      <div class="info-box">
        <strong>Smart Detection:</strong> The system can distinguish between local edits (you changed the sheet) and Arena changes (someone updated Arena) by comparing BOM checksums.
      </div>

      <h3>Viewing Rack History</h3>
      <p>Access the centralized history tracking system:</p>
      <div class="menu-path">Arena ‚Üí BOM Operations ‚Üí View Rack History</div>

      <p>The History tab provides:</p>
      <ul>
        <li><strong>Summary Section:</strong> Current status of all racks at a glance</li>
        <li><strong>Detail Section:</strong> Chronological log of all events</li>
        <li><strong>Filter Sidebar:</strong> Automatically opens to help you navigate</li>
        <li><strong>Quick Stats:</strong> Count of racks by status</li>
      </ul>

      <h3>Using the History Filter</h3>
      <p>The filter sidebar (auto-opens when viewing History tab) lets you:</p>
      <ol>
        <li>Select a specific rack from the dropdown</li>
        <li>Click "Apply Filter" to show only that rack's events</li>
        <li>Click "Clear Filter" to show all events</li>
        <li>View quick stats showing rack counts by status</li>
      </ol>

      <div class="tip-box">
        <strong>Navigation Tip:</strong> Click the "üìã History" link in any rack sheet (cell D1) to jump directly to the History tab filtered for that rack!
      </div>

      <h3>Event Types Logged</h3>
      <p>The History tab records the following events:</p>
      <ul>
        <li><strong>Rack Created</strong> - New rack configuration created</li>
        <li><strong>Status Change</strong> - Rack sync status updated</li>
        <li><strong>Local Edit</strong> - User edited rack BOM</li>
        <li><strong>Refresh Accepted/Declined</strong> - Arena BOM refresh decision</li>
        <li><strong>POD Push</strong> - Rack included in push to Arena</li>
        <li><strong>BOM Pull</strong> - BOM pulled from Arena</li>
        <li><strong>Manual Sync</strong> - User manually marked as synced</li>
        <li><strong>Batch Check</strong> - Status check operation</li>
        <li><strong>Error</strong> - Operation failed</li>
      </ul>

      <h3>Handling Out-of-Sync Racks</h3>
      <p>When a rack shows üü° (Arena Modified):</p>
      <ol>
        <li>Open the rack sheet</li>
        <li>Right-click to access "Refresh BOM from Arena"</li>
        <li>Review the proposed changes in the diff dialog</li>
        <li>Accept to sync with Arena or decline to keep current BOM</li>
        <li>Status updates to üü¢ SYNCED if you accept</li>
      </ol>

      <h3>Advanced Status Tools</h3>
      <p>Power users can access advanced tools:</p>
      <div class="menu-path">Arena ‚Üí Setup ‚Üí Advanced</div>

      <ul>
        <li><strong>Mark Current Rack as Synced:</strong> Manually override status (use with caution!)</li>
        <li><strong>Validate History Integrity:</strong> Check for missing/orphaned/invalid data</li>
        <li><strong>Repair History Issues:</strong> Auto-fix common problems</li>
      </ul>

      <div class="warning-box">
        <strong>Protected Data:</strong> The History tab is protected from manual editing to maintain data integrity. All updates are made automatically by the system.
      </div>
    </div>

    <!-- Tab 5: Publishing -->
    <div class="tab-content">
      <h2>Publishing to Arena</h2>

      <p>Ready to push your data center design to Arena? The "Push BOMs to Arena" feature creates a complete hierarchy in Arena.</p>

      <h3>Understanding the POD Structure</h3>
      <p>The system creates a three-level hierarchy in Arena:</p>
      <ul>
        <li><strong>POD (Point of Delivery):</strong> The top-level item representing your entire data center or section</li>
        <li><strong>Row Items:</strong> One for each row in your overview, with Row Location attribute tracking positions</li>
        <li><strong>Rack Items:</strong> Individual racks with their component BOMs</li>
      </ul>

      <h3>The Publishing Workflow</h3>
      <div class="step-box">
        <span class="step-number">1</span>
        <strong>Start the publish process</strong>
        <div class="menu-path">Arena ‚Üí BOM Operations ‚Üí Push BOMs to Arena</div>
      </div>

      <div class="step-box">
        <span class="step-number">2</span>
        <strong>Pre-flight validation</strong>
        <p>The system performs extensive validation before making any changes to Arena:</p>
        <ul>
          <li>Checks all rack configurations are valid</li>
          <li>Verifies all Arena items exist</li>
          <li>Validates BOM structure integrity</li>
          <li>Shows preview of what will be created/updated</li>
        </ul>
      </div>

      <div class="step-box">
        <span class="step-number">3</span>
        <strong>Review and confirm</strong>
        <p>Review the validation results and choose to proceed or cancel.</p>
      </div>

      <div class="step-box">
        <span class="step-number">4</span>
        <strong>Custom rack creation (if needed)</strong>
        <p>If you have PLACEHOLDER racks not yet in Arena, you'll be prompted to:</p>
        <ul>
          <li>Provide rack name and description</li>
          <li>Select Arena category</li>
          <li>Set lifecycle phase</li>
        </ul>
        <p>The system will create the Arena item and populate its BOM automatically!</p>
      </div>

      <div class="step-box">
        <span class="step-number">5</span>
        <strong>Choose: Update or Create New</strong>
        <p>Decide whether to update existing POD/Row items or create fresh ones.</p>
      </div>

      <div class="step-box">
        <span class="step-number">6</span>
        <strong>Name your items</strong>
        <p>Provide names for Row items and the POD (e.g., "North Row A", "Data Center Pod A")</p>
      </div>

      <div class="step-box">
        <span class="step-number">7</span>
        <strong>Rollback protection</strong>
        <p>If any errors occur during the push, the system can automatically rollback changes to maintain data integrity.</p>
      </div>

      <div class="step-box">
        <span class="step-number">8</span>
        <strong>Success!</strong>
        <p>Your overview sheet is updated with:</p>
        <ul>
          <li>POD information at the top with Arena link</li>
          <li>Row Item column with links to each row in Arena</li>
          <li>Rack status indicators updated to üü¢ SYNCED</li>
          <li>History events logged for audit trail</li>
        </ul>
      </div>

      <h3>What Gets Created in Arena</h3>
      <ul>
        <li><strong>Placeholder Rack Items:</strong> Created with full BOMs from your configurations</li>
        <li><strong>Row Items:</strong> Each with "Row Location" attribute (e.g., "Pos 1, Pos 3, Pos 5") and BOM showing all racks with correct quantities</li>
        <li><strong>Rack Position Tracking (if configured):</strong> Each rack on a Row's BOM is tagged with its specific positions (e.g., "Pos 1, Pos 3, Pos 8")</li>
        <li><strong>POD Item:</strong> Top-level assembly containing all rows</li>
      </ul>

      <div class="info-box">
        <strong>New Features:</strong> The latest version includes pre-flight validation, rollback support, and comprehensive error handling to ensure safe Arena updates!
      </div>

      <div class="warning-box">
        <strong>Note:</strong> The system creates Arena items in the correct order:
        <ol>
          <li>Placeholder racks first (so they exist for row BOMs)</li>
          <li>Then row items (so they exist for POD BOM)</li>
          <li>Finally the POD item at the top</li>
        </ol>
      </div>

      <div class="tip-box">
        <strong>Pro Tip:</strong> After publishing, click the Arena links in your overview sheet to jump directly to those items in Arena PLM!
      </div>

      <h3>Need Help?</h3>
      <p>If you run into any issues:</p>
      <ul>
        <li>Check that your Arena connection is working</li>
        <li>Review the validation results carefully</li>
        <li>Check the Apps Script logs for detailed error messages</li>
        <li>Use "Validate History Integrity" to check for data issues</li>
        <li>Verify all rack configurations have valid Arena items</li>
      </ul>
    </div>

    <!-- Tab 6: About -->
    <div class="tab-content">
      <h2>About This Tool</h2>

      <div class="creator-card">
        <img class="creator-photo" src="https://media.licdn.com/dms/image/v2/D5603AQFVGXhMJl_YOQ/profile-displayphoto-shrink_800_800/profile-displayphoto-shrink_800_800/0/1708455515046?e=1742428800&v=beta&t=xQJxMJKxF7zDxP0FJKxJ0MJKxF7zDxP0FJKxJ0MJKxF"
             alt="Dan Bacon"
             onerror="this.src='data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 200 200%22%3E%3Ccircle cx=%22100%22 cy=%22100%22 r=%22100%22 fill=%22%231a73e8%22/%3E%3Ctext x=%22100%22 y=%22115%22 font-size=%2280%22 text-anchor=%22middle%22 fill=%22white%22 font-family=%22Arial%22%3EDB%3C/text%3E%3C/svg%3E'">

        <h3 class="creator-name">Dan Bacon</h3>
        <p class="creator-title">PTC Arena PLM</p>

        <div class="creator-message">
          <p>This tool was built to make Arena PLM integration seamless and powerful. Whether you're managing data center infrastructure, manufacturing assemblies, or any hierarchical product structure, this tool helps you design, track, and sync everything with Arena.</p>

          <p>If you find this tool helpful or have ideas for improvements, I'd love to hear from you!</p>
        </div>

        <a href="https://www.linkedin.com/in/thedanielbacon" target="_blank" class="linkedin-button">
          Connect on LinkedIn
        </a>
      </div>

      <div class="info-box" style="text-align: center;">
        <strong>Open Source & Collaboration</strong>
        <p style="margin-top: 10px;">This project is built with Google Apps Script and integrates with Arena PLM's REST API. Interested in contributing or have questions? Reach out on LinkedIn!</p>
      </div>

      <div class="tip-box" style="text-align: center;">
        <strong>Made with</strong> üîß Google Apps Script ‚Ä¢ üîó Arena PLM API ‚Ä¢ ‚ù§Ô∏è Passion for great tools
      </div>
    </div>
  </div>

  <script>
    var terminology = {
      entity_singular: 'Configuration',
      entity_plural: 'Configurations',
      entity_singular_lower: 'configuration',
      entity_plural_lower: 'configurations',
      hierarchy_level_0: 'Assembly',
      hierarchy_level_1: 'SubAssembly',
      hierarchy_level_2: 'Configuration'
    };

    // Load terminology from backend
    google.script.run
      .withSuccessHandler(function(terms) {
        terminology = terms;
        updateContentWithTerminology();
      })
      .withFailureHandler(function(error) {
        console.log('Using default terminology:', error);
        updateContentWithTerminology();
      })
      .getTerminologyForUI();

    function updateContentWithTerminology() {
      var entity = terminology.entity_singular;
      var entityLower = terminology.entity_singular_lower;
      var entityPlural = terminology.entity_plural;
      var entityPluralLower = terminology.entity_plural_lower;
      var level0 = terminology.hierarchy_level_0;
      var level1 = terminology.hierarchy_level_1;
      var level2 = terminology.hierarchy_level_2;

      // Update header
      document.getElementById('headerTitle').textContent = 'Arena ' + entity + ' Manager - Help Guide';
      document.getElementById('headerSubtitle').textContent = 'Your complete guide to managing ' + entityPluralLower + ' with Arena PLM';

      // Replace terminology throughout the document
      replacePlaceholders();
    }

    function replacePlaceholders() {
      // Get all text nodes and replace placeholders
      var walker = document.createTreeWalker(
        document.body,
        NodeFilter.SHOW_TEXT,
        null,
        false
      );

      var nodesToReplace = [];
      var node;

      while (node = walker.nextNode()) {
        if (node.nodeValue.match(/\b(rack|racks|Rack|Racks|RACK|data center|datacenter|Data Center|POD|Row|point of delivery)\b/i)) {
          nodesToReplace.push(node);
        }
      }

      // Perform replacements
      nodesToReplace.forEach(function(textNode) {
        var text = textNode.nodeValue;

        // Replace terminology
        text = text.replace(/\bdata center\b/gi, terminology.entity_singular_lower + ' infrastructure');
        text = text.replace(/\bRack\b(?![ -])/g, terminology.entity_singular);
        text = text.replace(/\bracks\b/g, terminology.entity_plural_lower);
        text = text.replace(/\bRacks\b/g, terminology.entity_plural);
        text = text.replace(/\brack\b/gi, terminology.entity_singular_lower);
        text = text.replace(/\bPOD\b/g, terminology.hierarchy_level_0);
        text = text.replace(/\bRow\b(?![ ]Location)/g, terminology.hierarchy_level_1);
        text = text.replace(/\bPoint of Delivery\b/gi, terminology.hierarchy_level_0);

        textNode.nodeValue = text;
      });
    }

    function showTab(index) {
      // Hide all tabs and content
      var tabs = document.getElementsByClassName('tab');
      var contents = document.getElementsByClassName('tab-content');

      for (var i = 0; i < tabs.length; i++) {
        tabs[i].classList.remove('active');
        contents[i].classList.remove('active');
      }

      // Show selected tab and content
      tabs[index].classList.add('active');
      contents[index].classList.add('active');
    }
  </script>
</body>
</html>
